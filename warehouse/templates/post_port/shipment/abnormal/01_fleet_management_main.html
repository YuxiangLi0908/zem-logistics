{% extends 'base.html' %}

{% block content %}
<div><b>出库批次异常</b></div>
<form method="post" action="" onsubmit="showLoadingBar()">
    {% csrf_token %}
    <div>
        <b style="margin-right: 5px;">选择发货仓库:</b>
        <input type="hidden" name="step" value="fleet_warehouse_search">
        {{ warehouse_form.name }}
        <button type="submit">确认</button>
    </div>
</form>

<div>
    <table class="table" style="font-size: 11px;">
        <thead>
            <tr>
                <th class="th">出库批次号</th>
                <th class="th">目的地</th>
                <th class="th">预约批次</th>
                <th class="th">预约号</th>
                <th class="th">提货时间</th>
            </tr>
        </thead>
        <tbody>
            {% for f in fleet %}
            <tr>
                <td class="td"><a href="#" onclick="add_po_popup(this)">{{ f.fleet_number }}</a></td>
                <td class="td">{{ f.destination }}</td>
                <td class="td">{{ f.shipment_batch_number }}</td>
                <td class="td">{{ f.appointment_id }}</td>
                <td class="td">{{ f.appointment_datetime }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<div class="popup-window" style="display: none; z-index:999; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background-color: white; border: 1px solid gray; padding: 20px; max-height: 50%; overflow-y: scroll;">
    <div style="display: flex;">
        <input type="hidden" name="step" value="alter_fleet_schedule">
        <input type="hidden" name="alter_type" value="add">
        <input type="hidden" name="area" value="{{ area }}">
        <input type="hidden" name="shipment_batch_number" value="{{ shipment.shipment_batch_number }}">
        <button type="submit" class="btn btn-primary" onclick="edit_add_payload(this)" style="font-size: 11px; margin-right: 5px;">确认添加</button>
        <button id="editButton" type="button" class="btn btn-danger" onclick="add_po_popup(this)" style="font-size: 11px;">返回</button>
    </div>
</div>

<script>
    function add_po_popup(button) {
        var popup = document.querySelector('.popup-window');
        if (popup.style.display === 'none') {
            popup.style.display = 'block';
        } else {
            popup.style.display = 'none';
        }
    };
</script>
{% endblock %}